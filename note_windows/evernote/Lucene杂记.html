<html>
<head>
  <title>Lucene杂记</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/272236; Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="7493"/>
<h1>Lucene杂记</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2014/9/21 8:33</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2014/9/23 18:18</i></td></tr>
<tr><td><b>标签：</b></td><td><i>Lucene</i></td></tr>
</table>
</div>
<br/>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div>seo优化</div><div>Lucene是针对互联网搜索的一个解决方案。</div><span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;">1.什么是全文搜索（Full-Text Retrieval）</span><div>全文检索是计算机程序通过扫描文章中的每一个词，对每一个词建立一个索引，指明该词在文章中出现的次数和位置。当用户查询时根据建立的索引查找，类似于通过字典的检索字表查字的过程 。 </div>
   1，只处理文本。<br/>
   2，不处理语义。<br/>
   3，搜索时英文不区分大小写。<br/><div>   4，结果列表有相关度排序。 <br/></div><div>Lucene通俗讲是用于创建索引。</div><div><br/></div><div><span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;">2.更新索引库的模式</span></div><div>索引文件的检索与维护，更新是先删除后创建。<br/></div><div>维护倒排索引有三个操作：添加、删除和更新文档。但是更新操作需要较高的代价。因为文档修改后（即使是很小的修改），就可能会造成文档中的很多的关键词的位置都发生了变化，这就需要频繁的读取和修改记录，这种代价是相当高的。因此，一般不进行真正的更新操作，而是使用“先删除，再创建”的方式代替更新操作。<br/></div><div><br/></div><div><span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;">3. 分词器Analyzer</span></div><div>3.1.在创建索引和使用字符串搜索的时候要使用同一分词器，否则可能搜索不出结果。</div><div>3.2.Analyzer的作用：对于给定的一个文本信息，按分词器规则取出其中的所有词。</div><div>     Analyzer是一个抽象类，具体分词规则由其子类实现。</div><div><span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;"><br/></span></div><div><span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;">4.分词器（英文）的一般工作流程：</span></div>
4.1、切分关键词<br/>
4.2、去除停用词<br/>
4.3、对于英文单词，把所有字母转为小写（搜索时不区分大小写）<br/>
说明：有的分词器还对英文进行形态还原，就是去除单词词尾的形态变化，将其还原为词的原形。这样做可以搜索出更多有意义的结果。如搜索sutdent时，也可以搜索出students，这是很有用的。<br/><div><br/></div><div><span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;">5.常用的中文分词器</span></div><div>   中文的分词比较复杂，因为不是一个字就是一个词，而且一个词在另外一个地方就可能不是一个词，如在“帽子和服装”中，“和服”就不是一个词。对于中文分词，通常有三种方式：单字分词、二分法分词、词典分词。<br/>
     1、单字分词：就是按照中文一个字一个字地进行分词。如：“我们是中国人”，效果：“我”、“们”、“是”、“中”、“国”、“人”。（StandardAnalyzer、ChineseAnalyzer就是这样）。<br/>
     2、二分法分词：按两个字进行切分。如：“我们是中国人”，效果：“我们”、“们是”、“是中”、“中国”、“国人”。（CJKAnalyzer就是这样）。<br/>
     3、词库分词：按某种算法构造词，然后去匹配已建好的词库集合，如果匹配到就切分出来成为词语。通常词库分词被认为是最理想的中文分词算法。如：“我们是中国人”，效果为：“我们”、“中国人”。（使用<span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;">极易分词的MMAnalyzer</span>。可以使用“极易分词”，或者是<span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;">“庖丁分词”分词器、IKAnalyzer</span>）。</div><div><br/></div><div><span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;">6.使用“庖丁分词”分词器的步骤</span></div><div>1、导入IK Analyzer 2012FF_hf1.zip包<br/>
2、引入分词器的配置文件IKAnalyzer.cfg.xml（配置停用词和自定义扩展词），<br/>
     放到类路径下<br/>
3、引入ext_stopword.dic文件（存放停用词），放置到类路径下<br/>
4、新建ext_dict.dic文件（存放自定义的扩展词），放置到类路径下<br/></div><div><span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;"><br/></span></div><div><span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;">7.优化索引库</span></div><div><br/></div><div>优化的第一种方式:通过 IndexWriterConfig 优化设置mergePolicy（合并策略）</div><div>         LogDocMergePolicy mergePolicy=new LogDocMergePolicy(); <br/>
          /**<br/>
          * 当这个值越小，更少的内存会被运用当创建索引的时候，搜索的时候越快，创建的时候越慢。<br/>
          * 当这个值越大，更多的内存会被运用当创建索引的时候，搜索的时候越慢，创建的时候越快..<br/>
          * larger values &gt;10<br/>
          *<br/>
          * 2&lt;=smaller&lt;=10<br/>
          *<br/>
          */<br/>
          //设置合并因子..<br/>
          mergePolicy.setMergeFactor(10);</div><div><br/></div><div>第二：通过directory 去优化....</div><div><div>Lucene提供了两个子类：FSDirectory与RAMDirectory。<br/>
      FSDirectory：在文件系统中，是真实的文件夹与文件。<br/>
      RAMDirectory：在内存中，是模拟的文件夹与文件。<br/>
      RAMDirectory与FSDirectory相比：<br/>
      1、因为没有IO操作，所以速度快（优点）。<br/>
      2，因为在内存中，所以在程序退出后索引库数据就不存在了（缺点）。</div><br/></div><div><br/></div><div>第三：索引文件越大，会影响检索的速度..  (减少索引文件的大小)</div><div>1:排除停用词..</div><div><br/></div><div>第四：将索引分目盘存放  将数据归类...</div><div><br/></div><div><span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;">8.相关度排序</span></div><div>1.相关度排序得分</div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>1，相关度得分是在查询时根据查询条件实进计算出来的</div><div>2，如果索引库数据不变，查询条件不变，查出的文档得分也不变</div></blockquote><div>2、Boost和Sort<br/></div><div> 通过改变文档Boost值来改变排序结果。</div><div> 使用Sort对象定制排序。</div><div><br/></div><div><span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;">9.过滤</span></div><div>使用Filter可以对搜索结果进行过滤以获得更小范围的结果。使用Filter对性能的影响很大（有可能会使查询慢上百倍）。但也可使用相应的查询实现一样的效果（下一章讲）。<br/></div><div><br/></div><div><span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;">10.查询</span></div><div>使用查询字符串：QueryParser+ MultiFieldQueryParser的查询方式<br/>
1、QueryParser：只在一个字段中查询<br/>
2、MultiFieldQueryParser：可以在多个字段查询<br/></div><div>几种查询方法：范围查询、关键词查询、通配符查询、查询所有、模糊查询、短语查询、布尔查询</div><div><br/></div><div><img src="Lucene杂记_files/Image.png" type="image/png" style="cursor: default;"/></div><div><br/></div><div><img src="Lucene杂记_files/Image [1].png" type="image/png" style="cursor: default;"/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></div>
</div></body></html> 