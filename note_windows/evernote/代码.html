<html>
<head>
  <title>代码</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/272236; Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="2964"/>
<h1>代码</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2014/8/4 22:52</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2014/8/5 19:09</i></td></tr>
</table>
</div>
<br/>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">工具类：</span></font></div><div align="left"><div align="left"><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font> <font face="Consolas"><span style="font-size:12pt">HibernateUtils {</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>static</b></span></font> <font face="Consolas"><span style="font-size:12pt">SessionFactory</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font><font face="Consolas"><span style="font-size:12pt">;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>static</b></span></font><font face="Consolas"><span style="font-size:12pt">{</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Configuration configuration =</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>new</b></span></font> <font face="Consolas"><span style="font-size:12pt">Configuration();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           configuration.configure();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font> <font face="Consolas"><span style="font-size:12pt">= configuration.buildSessionFactory();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">}</span></font></div></div><div align="left"><hr/></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">1，crud</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt"> * 完成Person表的</span> <span style="font-size:12pt"><u>crud</u></span><span style="font-size:12pt">操作</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt"> *</span></font> <font color="#7F9FBF" face="Consolas"><span style="font-size:12pt"><b>@author</b></span></font> <font color="#3F5FBF" face="Consolas"><span style="font-size:12pt"><u>zd</u></span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt"> *</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt"> */</span></font></div><div align="left"><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font> <font face="Consolas"><span style="font-size:12pt">PersonCRUD</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>extends</b></span></font> <font face="Consolas"><span style="font-size:12pt">HibernateUtils{</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      * save操作</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#646464" face="Consolas"><span style="font-size:12pt">@Test</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testSavePerson(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//加载</span><span style="font-size:12pt"><u>hibernate</u></span> <span style="font-size:12pt">的配置文件</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Configuration configuration =</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>new</b></span></font> <font face="Consolas"><span style="font-size:12pt">Configuration();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           configuration.configure();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//产生sessionFactory</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           SessionFactory sessionFactory = configuration.buildSessionFactory();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//打开session</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session = sessionFactory.openSession();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//开启事务</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Transaction transaction = session.beginTransaction();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//创建一个对象</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Person person =</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>new</b></span></font> <font face="Consolas"><span style="font-size:12pt">Person();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           person.setName(</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt">&quot;王二麻子&quot;</span></font><font face="Consolas"><span style="font-size:12pt">);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           person.setDescription(</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt">&quot;霸气&quot;</span></font><font face="Consolas"><span style="font-size:12pt">);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.save(person);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//事务提交</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           transaction.commit();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//session关闭</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      * update操作</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#646464" face="Consolas"><span style="font-size:12pt">@Test</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testUpdatePerson(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font><font face="Consolas"><span style="font-size:12pt">.openSession();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Transaction transaction = session.beginTransaction();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">            * 1、把id为1的对象从数据库中提取出来</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">            * 2、修改</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">            */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">            * 1、存放持久化类的class形式</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">            * 2、存放的是主键的值</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">            */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Person person = (Person)session.get(Person.</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font><font face="Consolas"><span style="font-size:12pt">, 1L);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           person.setDescription(</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt">&quot;真的很霸气&quot;</span></font> <font face="Consolas"><span style="font-size:12pt">);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.update(person);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           transaction.commit();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      * 根据主键从数据库中查询一条记录</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#646464" face="Consolas"><span style="font-size:12pt">@Test</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testGetPerson(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font><font face="Consolas"><span style="font-size:12pt">.openSession();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Person</span> <span style="font-size:12pt"><u>person</u></span> <span style="font-size:12pt">= (Person)session.get(Person.</span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font><font face="Consolas"><span style="font-size:12pt">, 1L);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      * 查询数据库中的所有的记录</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#646464" face="Consolas"><span style="font-size:12pt">@Test</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testQueryAllPerson(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font><font face="Consolas"><span style="font-size:12pt">.openSession();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           List&lt;Person&gt; persons =</span> <span style="font-size:12pt"><u>session.createQuery(</u></span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><u>&quot;from Person&quot;</u></span></font><font face="Consolas"><span style="font-size:12pt"><u>).list()</u></span><span style="font-size:12pt">;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>for</b></span></font> <font face="Consolas"><span style="font-size:12pt">(Person person : persons) {</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                System.</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>out</i></span></font><font face="Consolas"><span style="font-size:12pt">.println(person.getName());</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#646464" face="Consolas"><span style="font-size:12pt">@Test</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testDelete(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">            * 1、先根据id把记录查询出来</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">            * 2、执行删除操作</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">            */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font><font face="Consolas"><span style="font-size:12pt">.openSession();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Transaction transaction = session.beginTransaction();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Person person = (Person)session.get(Person.</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font><font face="Consolas"><span style="font-size:12pt">, 2L);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.delete(person);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           transaction.commit();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      * 在执行update操作的时候，创建一个新的对象</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      *     如果id存在，则执行update语句</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      *     如果id不存在，则报错</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#646464" face="Consolas"><span style="font-size:12pt">@Test</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testUpdate_Test(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font><font face="Consolas"><span style="font-size:12pt">.openSession();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Transaction transaction = session.beginTransaction();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Person person =</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>new</b></span></font> <font face="Consolas"><span style="font-size:12pt">Person(1L);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           person.setId(6L);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           person.setName(</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt">&quot;aaaa&quot;</span></font><font face="Consolas"><span style="font-size:12pt">);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.update(person);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           transaction.commit();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">}</span></font></div><hr/><div>2.对象的状态（以前连接过后来断了连接的时候变为托管状态）</div><div><img src="代码_files/ScreenClip.png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt"> * 对象的状态</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt"> *</span></font> <font color="#7F9FBF" face="Consolas"><span style="font-size:12pt"><b>@author</b></span></font> <font color="#3F5FBF" face="Consolas"><span style="font-size:12pt"><u>zd</u></span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt"> *</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt"> */</span></font></div><div align="left"><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font> <font face="Consolas"><span style="font-size:12pt">StateTest</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>extends</b></span></font> <font face="Consolas"><span style="font-size:12pt">HibernateUtils{</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      * session.save方法把一个对象变成持久化状态的对象</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#646464" face="Consolas"><span style="font-size:12pt">@Test</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testSavePerson(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font><font face="Consolas"><span style="font-size:12pt">.openSession();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Transaction transaction = session.beginTransaction();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Person person =</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>new</b></span></font> <font face="Consolas"><span style="font-size:12pt">Person();</span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//临时状态</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           person.setName(</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt">&quot;班长&quot;</span></font><font face="Consolas"><span style="font-size:12pt">);</span></font><font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//临时状态</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           person.setDescription(</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt">&quot;就是牛&quot;</span></font><font face="Consolas"><span style="font-size:12pt">);</span></font><font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//临时状态</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.save(person);</span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//把一个对象由临时状态变成持久化状态</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           transaction.commit();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#646464" face="Consolas"><span style="font-size:12pt">@Test</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testGet(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font><font face="Consolas"><span style="font-size:12pt">.openSession();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Person</span> <span style="font-size:12pt"><u>person</u></span> <span style="font-size:12pt">= (Person)session.get(Person.</span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font><font face="Consolas"><span style="font-size:12pt">, 1L);</span></font><font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//person为持久化状态的对象</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      * session.update方法把一个对象变成持久化状态的对象</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      *    主要的作用就是把一个脱管状态的对象重新持久化</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#646464" face="Consolas"><span style="font-size:12pt">@Test</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testUpdate(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font><font face="Consolas"><span style="font-size:12pt">.openSession();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Transaction transaction = session.beginTransaction();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Person person = (Person)session.get(Person.</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font><font face="Consolas"><span style="font-size:12pt">, 1L);</span></font><font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//person为持久化状态的对象</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           person.setDescription(</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt">&quot;2222&quot;</span></font><font face="Consolas"><span style="font-size:12pt">);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.update(person);</span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//把一个对象变成持久化状态的对象</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           transaction.commit();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      * evict方法可以把一个对象从持久化状态转变成脱管状态</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#646464" face="Consolas"><span style="font-size:12pt">@Test</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testEvict(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font><font face="Consolas"><span style="font-size:12pt">.openSession();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Transaction transaction = session.beginTransaction();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Person person = (Person)session.get(Person.</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font><font face="Consolas"><span style="font-size:12pt">, 1L);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           person.setDescription(</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt">&quot;555&quot;</span></font><font face="Consolas"><span style="font-size:12pt">);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.evict(person);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           transaction.commit();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      * evict方法和update方法结合</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#646464" face="Consolas"><span style="font-size:12pt">@Test</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testEvictAndUpdate(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font><font face="Consolas"><span style="font-size:12pt">.openSession();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Transaction transaction = session.beginTransaction();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Person person = (Person)session.get(Person.</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font><font face="Consolas"><span style="font-size:12pt">, 1L);</span></font><font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//持久化状态</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           person.setDescription(</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt">&quot;888&quot;</span></font><font face="Consolas"><span style="font-size:12pt">);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.evict(person);</span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//脱管状态</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.update(person);</span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//持久化状态</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           transaction.commit();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      * evict方法和save方法结合</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#646464" face="Consolas"><span style="font-size:12pt">@Test</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testEvictAndSave(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font><font face="Consolas"><span style="font-size:12pt">.openSession();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Transaction transaction = session.beginTransaction();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Person person = (Person)session.get(Person.</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font><font face="Consolas"><span style="font-size:12pt">, 1L);</span></font><font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//持久化状态</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           person.setDescription(</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt">&quot;888&quot;</span></font><font face="Consolas"><span style="font-size:12pt">);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.evict(person);</span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//脱管状态</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.save(person);</span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//持久化状态  </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           transaction.commit();</span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//当事务提交的时候，会插入一行数据</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      * clear</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#646464" face="Consolas"><span style="font-size:12pt">@Test</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testClear(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>sessionFactory</i></span></font><font face="Consolas"><span style="font-size:12pt">.openSession();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Transaction transaction = session.beginTransaction();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Person person = (Person)session.get(Person.</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font><font face="Consolas"><span style="font-size:12pt">, 1L);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           person.setDescription(</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt">&quot;4545&quot;</span></font><font face="Consolas"><span style="font-size:12pt">);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.clear();</span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//把</span><span style="font-size:12pt"><u>hibernate</u></span> <span style="font-size:12pt">中所有的持久化状态的对象变成脱管状态的对象</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           transaction.commit();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">/**</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      * session.close也是把一个对象的状态由持久化状态变成脱管</span></font></div><div align="left"><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">      */</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">}</span></font></div><div align="left"><hr/><hr/>
3.生命周期：</div><div align="left">·           <span style="color: rgb(100, 100, 100); font-family: Consolas; font-size: 12pt;">@Test</span></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testLoad(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =  HibernateSessionFactory.</span><span style="font-size:12pt"><i>getSession</i></span><span style="font-size:12pt">();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">          System.</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>out</i></span></font><font face="Consolas"><span style="font-size:12pt">.println(session.getStatistics().getEntityCount());</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Person person =(Person) session.load(Person.</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font><font face="Consolas"><span style="font-size:12pt">, 0L);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">          <b> System.</b></span></font><b><font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>out</i></span></font><font face="Consolas"><span style="font-size:12pt">.println(person);//有没有它有很大区别</span></font></b></div><div align="left"><font face="Consolas"><span style="font-size:12pt">          System.</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>out</i></span></font><font face="Consolas"><span style="font-size:12pt">.println(session.getStatistics().getEntityCount());</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">0</span></font></div></div><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">Hibernate:</span></font></div></div><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">    select</span></font></div></div><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">        person0_.id as id0_0_,</span></font></div></div><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">        person0_.name as name0_0_,</span></font></div></div><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">        person0_.desp as desp0_0_</span></font></div></div><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">    from</span></font></div></div><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">        person person0_</span></font></div></div><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">    where</span></font></div></div><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">        person0_.id=?</span></font></div></div><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">com.itheima.domain.Person@136d9d8</span></font></div></div><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">1</span></font></div></div></blockquote><div align="left"><div align="left"><div align="left"><div align="left"><font color="#646464" face="Consolas" size="4">      </font><span style="font-size: 12pt; color: rgb(100, 100, 100); font-family: Consolas;">@Test</span></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">testLoad(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           Session session =  HibernateSessionFactory.</span><span style="font-size:12pt"><i>getSession</i></span><span style="font-size:12pt">();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">          System.</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>out</i></span></font><font face="Consolas"><span style="font-size:12pt">.println(session.getStatistics().getEntityCount());</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span> <span style="font-size:12pt; background:#d4d4d4">Person</span> <span style="font-size:12pt"><u>person</u></span> <span style="font-size:12pt">=(</span><span style="font-size:12pt; background:#d4d4d4">Person</span><span style="font-size:12pt">) session.load(</span> <span style="font-size:12pt; background:#d4d4d4">Person</span><span style="font-size:12pt">.</span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font><font face="Consolas"><span style="font-size:12pt">, 0L);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">          System.</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>out</i></span></font><font face="Consolas"><span style="font-size:12pt">.println(session.getStatistics().getEntityCount());</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           session.close();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div></div><div align="left"><font face="Consolas"><span style="font-size:12pt"><br/></span></font></div></div></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div align="left"><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">0</span></font></div></div></div><div align="left"><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt">0</span></font></div></div></div></blockquote><div align="left"><div align="left"><div align="left"><font face="Consolas"><span style="font-size:12pt"><br/></span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt"><br/></span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt"><br/></span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt"><br/></span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt"><br/></span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt"><br/></span></font></div></div></div></div>
</div></body></html> 