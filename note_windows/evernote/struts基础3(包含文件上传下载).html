<html>
<head>
  <title>struts基础3(包含文件上传下载)</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/272236; Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="2611"/>
<h1>struts基础3(包含文件上传下载)</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2014/7/31 9:11</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2014/8/18 12:42</i></td></tr>
<tr><td><b>标签：</b></td><td><i>ActionContext, OGNL简介, struts2, ValueStack, 拦截器, 文件上传下载</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="mk:@MSITStore:F:\资料\API\servlet-api.chm::/jsdk23/javax/servlet/FilterChain.html"><i>mk:@MSITStore:F:\资料\API\servlet-api.chm::/jsdk23/javax/servlet/FilterChain.html</i></a></td></tr>
</table>
</div>
<br/>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><span style="font-size: 32px;"><b> 一、拦截器原理</b></span><div><b><span style="font-family: 黑体; font-size: 16pt;">1</span><font face="黑体" style="font-family: 黑体; font-size: 16pt;">、过滤器</font><font face="Arial" style="font-size: 16pt;">VS</font><font face="黑体" style="font-family: 黑体; font-size: 16pt;">拦截器</font></b></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><p style="margin-bottom: 0pt; margin-top: 0pt; font-size: 19px;"><span style="font-family: 宋体;">功能是一回事。</span></p><p style="margin-bottom: 0pt; margin-top: 0pt; font-size: 19px;"><span style="font-family: 宋体;">过滤器是<font face="Times New Roman">Servlet</font><font face="宋体">规范中的技术，可以对请求和响应进行过滤。</font></span></p><div style="font-size: 19px;">Struts2 拦截器在访问某个 Action 方法之前或之后<span style="font-family: 宋体;">对请求动作</span>实施拦截, Struts2 拦截器是可插拔的, 拦截器是 AOP 的一种实现．</div><div style="font-size: 19px;"><ol><li>拦截器栈(Interceptor Stack): 将拦截器按一定的顺序联结成一条链. 在访问被拦截的方法时, Struts2拦截器链中的拦截器就会按其之前定义的顺序被依次调用</li></ol></div><div style="font-size: 19px;"><img src="struts基础3(包含文件上传下载)_files/Image.png" type="image/png" height="835" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="713"/></div><span style="font-size: 19px;">     d</span><div style="font-size: 19px;"><img src="struts基础3(包含文件上传下载)_files/Image [1].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div></blockquote><div style="font-size: 32px;"><b><br/></b></div><div style="font-size: 32px;">Interceptor 接口</div><div style="font-size: 21px;"><img src="struts基础3(包含文件上传下载)_files/Image [2].png" type="image/png" style="cursor: default;cursor: default;"/></div><div style="font-size: 21px;">出现init及destroy方法，说明在内存中是单例的，可能有线程安全问题。</div><div style="font-size: 21px;">Struts 会依次调用程序员为每个 Action 而注册的每一个拦截器的 interecept 方法.<br/>
每次调用 intercept 方法时, Struts 会传递一个 ActionInvocation 接口的实例.<br/>
ActionInvocation: 代表一个给定动作的执行状态, 拦截器可以从该类的对象里获得与该动作相关联的 Action 对象和 Result 对象. 在完成拦截器自己的任务之后, 拦截器将调用 ActionInvocation 对象的 invoke 方法前进到 Action 处理流程的下一个环节.<br/>
还可以调用 ActionInvocation 对象的 addPreResultListener 方法给 ActionInvocation 对象 “挂” 上一个或多个 PreResultListener 监听器. 该监听器对象可以在动作执行完毕之后, 开始执行动作结果之前做些事情<br/>
AbstractInterceptor 类实现了 Interceptor 接口. 并为 init, destroy 提供了一个空白的实现<br/></div><div style="font-size: 21px;"><img src="struts基础3(包含文件上传下载)_files/Image [3].png" type="image/png" height="552" style="cursor: default;cursor: default;cursor: default;cursor: default;" width="978"/></div><div style="font-size: 21px;"><img src="struts基础3(包含文件上传下载)_files/Image [4].png" type="image/png" height="543" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="973"/></div><div style="font-size: 19px;"><div><b style="font-size: 32px;">二、自定义拦截器：</b></div></div><div style="font-size: 19px;"><b>1、步骤：</b></div><span style="font-size: 19px;"><b>a、编写一个类，直接或间接实现Interceptor接口。(拦截器会驻留内存),一般都选择继承AbstractInterceptor</b></span><div><img src="struts基础3(包含文件上传下载)_files/Image [5].png" type="image/png" height="198" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="731"/>\</div><div><font size="3" style="font-size: 19px;">invocation.invoke();为放行，类似于chain.doFilter(request,response);</font><br/><div style="font-size: 19px;"><span style="font-family: 宋体;"><b>b<font face="宋体">、需要在</font><font face="Times New Roman">struts.xml</font><font face="宋体">中进行定义</font></b></span></div><div style="font-size: 19px;"><span style="font-family: 宋体;"><b><font face="宋体">1）</font></b></span></div><div style="font-size: 19px;">2）因为struts2中如文件上传，数据验证，封装请求参数到action等功能都是由系统默认的defaultStack中的拦截器实现的，所以我们定义的拦截器需要引用系统默认的defaultStack，这样应用才可以使用struts2框架提供的众多功能。</div><span style="font-size: 19px;">如果希望包下的所有action都使用自定义的拦截器，可以通过&lt;default-interceptor-ref name=“permissionStack”/&gt;把拦截器定义为默认拦截器。注意：每个包只能指定一个默认拦截器。另外，一旦我们为该包中的某个action显式指定了某个拦截器，则默认拦截器不会起作用。</span><br/><div style="font-size: 19px;"><img src="struts基础3(包含文件上传下载)_files/Image [6].png" type="image/png" height="258" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="980"/></div><div style="font-size: 19px;"><span style="font-family: 宋体;"><b>c<font face="宋体">、在动作配置中就可以使用了</font></b></span></div><div><span style="font-family: 宋体;"><b><font face="宋体">1）</font></b></span></div><div><img src="struts基础3(包含文件上传下载)_files/Image [7].png" type="image/png" height="288" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="1040"/></div><div>2）</div><div><img src="struts基础3(包含文件上传下载)_files/Image [8].png" type="image/png" height="258" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="980"/></div><div><br/></div><div style="font-size: 21px;">2、<span style="background-color: rgb(212, 212, 212); font-family: Consolas;">MethodFilterInterceptor接口，实现了此接口后可以配置拦截</span><span style="background-color: rgb(232, 242, 254); color: rgb(63, 95, 191); font-family: Consolas;">includeMethods</span><span style="background-color: rgb(212, 212, 212); font-family: Consolas;">或不拦截</span><span style="background-color: rgb(232, 242, 254); color: rgb(63, 95, 191); font-family: Consolas;">excludeMethods</span><span style="background-color: rgb(212, 212, 212); font-family: Consolas;">哪些方法</span></div><div><img src="struts基础3(包含文件上传下载)_files/Image [9].png" type="image/png" height="231" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="847"/></div><div><br/></div><div><img src="struts基础3(包含文件上传下载)_files/Image [10].png" type="image/png" height="201" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="997"/></div><div><br/></div><div><img src="struts基础3(包含文件上传下载)_files/Image [11].png" type="image/png" height="408" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="1148"/></div><div><br/></div><div style="font-size: 32px;"><b>三、文件的上传和下载</b></div><div align="left" style="font-size: 24px;"><font face="Consolas"><span style="background-color: rgb(212, 212, 212);">FileUploadInterceptor有提供怎么的得到上传文件的数据。</span></font></div><div align="left" style="font-size: 24px;"><hr/></div><div><b style="font-size: 24px;">1.单文件</b></div><div><span style="font-size: 24px;">1.</span></div><div><font color="#7F0055" face="Consolas" style="font-size: 32px;"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas" style="font-size: 32px;"><span style="font-size:12pt"><b>class</b></span></font> <font face="Consolas" style="font-size: 32px;"><span style="font-size:12pt"><u>UploadAction</u></span></font> <font color="#7F0055" face="Consolas" style="font-size: 32px;"><span style="font-size:12pt"><b>extends</b></span></font> <font face="Consolas" style="font-size: 32px;"><span style="font-size:12pt">ActionSupport {</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>private</b></span></font> <font face="Consolas"><span style="font-size:12pt">File</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">file</span></font><font face="Consolas"><span style="font-size:12pt">;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>private</b></span></font> <font face="Consolas"><span style="font-size:12pt">String</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><u>contentType</u></span></font><font face="Consolas"><span style="font-size:12pt">;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>private</b></span></font> <font face="Consolas"><span style="font-size:12pt">String</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">filename</span></font><font face="Consolas"><span style="font-size:12pt">;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">setUpload(File file) {</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>this</b></span></font><font face="Consolas"><span style="font-size:12pt">.</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">file</span></font> <font face="Consolas"><span style="font-size:12pt">= file;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">      }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">    </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">setUploadContentType(String contentType) {</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">        </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>this</b></span></font><font face="Consolas"><span style="font-size:12pt">.</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">contentType</span></font> <font face="Consolas"><span style="font-size:12pt">= contentType;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">    </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">setUploadFileName(String filename) {</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">        </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>this</b></span></font><font face="Consolas"><span style="font-size:12pt">.</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">filename</span></font> <font face="Consolas"><span style="font-size:12pt">= filename;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">  </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font face="Consolas"><span style="font-size:12pt">String upload(){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           String path = ServletActionContext.</span><span style="font-size:12pt"><i>getServletContext</i></span><span style="font-size:12pt">().getRealPath(</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt">&quot;/images&quot;</span></font><font face="Consolas"><span style="font-size:12pt">);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           File direction =</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>new</b></span></font> <font face="Consolas"><span style="font-size:12pt">File(path);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>if</b></span></font><font face="Consolas"><span style="font-size:12pt">(!direction.exists()){</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                direction.mkdirs();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>try</b></span></font> <font face="Consolas"><span style="font-size:12pt">{</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                FileUtils.</span> <span style="font-size:12pt"><i>copyFile</i></span><span style="font-size:12pt">(</span></font><font color="#0000C0" face="Consolas"><span style="font-size:12pt">file</span></font><font face="Consolas"><span style="font-size:12pt">,</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>new</b></span></font> <font face="Consolas"><span style="font-size:12pt">File(direction,</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">filename</span></font><font face="Consolas"><span style="font-size:12pt">));</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>return</b></span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>SUCCESS</i></span></font><font face="Consolas"><span style="font-size:12pt">;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           }</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>catch</b></span></font> <font face="Consolas"><span style="font-size:12pt">(IOException e) {</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                e.printStackTrace();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>return</b></span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>ERROR</i></span></font><font face="Consolas"><span style="font-size:12pt">;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">}</span></font></div><div align="left" style="font-size: 24px;"><font face="Consolas">2.struts.xml中</font></div><div align="left"><div align="left"><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">struts</span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">constant</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;struts.devMode&quot;</i></span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">value</span></font><font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;true&quot;</i></span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">/&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">&lt;!-- 配置input视图的错误提示为中文，要加的常亮声明 ：struts.custom.i18n.resources在struts2-core-2.3.15.3.jar中org.apache.struts2的</span></font>default.properties<span style="font-size: 12pt; color: rgb(63, 95, 191); font-family: Consolas;">中可以找到--&gt;</span></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">constant</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;struts.custom.i18n.resources&quot;</i></span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">value</span></font><font face="Consolas"><span style="font-size:12pt">=</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;global&quot;</i></span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">/&gt;//其中global要与后边写的properties配置文件路径及姓名相同</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">package</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;p1&quot;</i></span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">extends</span></font><font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;struts-default&quot;</i></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">action</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;upload&quot;</i></span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">class</span></font><font face="Consolas"><span style="font-size:12pt">=</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;com.itheima.actions.UploadAction&quot;</i></span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">method</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;upload&quot;</i></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">interceptor-ref</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;defaultStack&quot;</i></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                     </span></font> <font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">&lt;!-- 限定文件传输类型 --&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                     </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">param</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font><font face="Consolas"><span style="font-size:12pt">=</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;fileUpload.allowedTypes&quot;</i></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font><font face="Consolas"><span style="font-size:12pt"><u>jpg</u></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">param</span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">interceptor-ref</span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">result</span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font><font face="Consolas"><span style="font-size:12pt">/success.jsp</span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">result</span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">result</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;error&quot;</i></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font><font face="Consolas"><span style="font-size:12pt">/error.jsp</span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font> <font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">result</span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">result</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;input&quot;</i></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font><font face="Consolas"><span style="font-size:12pt">/upload.jsp</span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font> <font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">result</span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">action</span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">package</span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">struts</span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left" style="font-size: 24px;"><font face="Consolas">3.页面</font></div></div><div style="font-size: 32px;"><img src="struts基础3(包含文件上传下载)_files/Image [12].png" type="image/png" height="103" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="676"/></div><div style="font-size: 21px;">4、修改<span style="color: rgb(63, 95, 191); font-family: Consolas; text-align: -webkit-left;">input视图的错误提示为中文</span></div><div style="font-size: 21px;">第一步:创建新的资源文件 例如fileuploadmessage.properties,放置在src下<br/>
           在该资源文件中增加如下信息<br/>
struts.messages.error.uploading=上传错误: {0}<br/>
struts.messages.error.file.too.large=上传文件太大: {0} &quot;{1}&quot; &quot;{2}&quot; {3}<br/>
struts.messages.error.content.type.not.allowed=上传文件的类型不允许: {0} &quot;{1}&quot; &quot;{2}&quot; {3}<br/>
struts.messages.error.file.extension.not.allowed=上传文件的后缀名不允许: {0} &quot;{1}&quot; &quot;{2}&quot; {3}<br/><br/>
第二步:在struts.xml文件加载该资源文件<br/><br/>
       &lt;!-- 配置上传文件的出错信息的资源文件 --&gt;<br/>
       &lt;constant name=&quot;struts.custom.i18n.resources&quot; value=“cn….xxx.fileuploadmessage“/&gt;</div><div style="font-size: 32px;"><img src="struts基础3(包含文件上传下载)_files/Image [13].png" type="image/png" height="289" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="846"/></div><div style="font-size: 21px;">2.多文件上传（在单文件上传上修改，需要修改的地方如下）</div><div style="font-size: 32px;"><img src="struts基础3(包含文件上传下载)_files/Image [14].png" type="image/png" height="291" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="721"/></div><div style="font-size: 32px;"><img src="struts基础3(包含文件上传下载)_files/Image [15].png" type="image/png" height="326" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="843"/></div><div style="font-size: 16px;"><br/></div><div style="font-size: 32px;"><img src="struts基础3(包含文件上传下载)_files/Image [16].png" type="image/png" height="175" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="735"/></div><div style="font-size: 21px;">3.文件下载</div><div style="font-size: 32px;"><div align="left"><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>class</b></span></font> <font face="Consolas"><span style="font-size:12pt"><u>DownloadAction</u></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>extends</b></span></font> <font face="Consolas"><span style="font-size:12pt">ActionSupport {</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>private</b></span></font> <font face="Consolas"><span style="font-size:12pt">InputStream</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">image</span></font><font face="Consolas"><span style="font-size:12pt">;</span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//用in有问题的</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>private</b></span></font> <font face="Consolas"><span style="font-size:12pt">String</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">filename</span></font><font face="Consolas"><span style="font-size:12pt">;</span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//文件名</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>private</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>long</b></span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">filesize</span></font><font face="Consolas"><span style="font-size:12pt">;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font face="Consolas"><span style="font-size:12pt">InputStream getImage() {</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>return</b></span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">image</span></font><font face="Consolas"><span style="font-size:12pt">;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font color="#010101" face="Consolas"><span style="font-size:12pt"><br/></span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>void</b></span></font> <font face="Consolas"><span style="font-size:12pt">setImage(InputStream image) {</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>this</b></span></font><font face="Consolas"><span style="font-size:12pt">.</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">image</span></font> <font face="Consolas"><span style="font-size:12pt">= image;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font face="Consolas"><span style="font-size:12pt">String getFilename() {</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>return</b></span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">filename</span></font><font face="Consolas"><span style="font-size:12pt">;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font color="#010101" face="Consolas"><span style="font-size:12pt"><br/></span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>long</b></span></font> <font face="Consolas"><span style="font-size:12pt">getFilesize() {</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>return</b></span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">filesize</span></font><font face="Consolas"><span style="font-size:12pt">;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font color="#010101" face="Consolas"><span style="font-size:12pt"><br/></span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>public</b></span></font> <font face="Consolas"><span style="font-size:12pt">String download()</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>throws</b></span></font> <font face="Consolas"><span style="font-size:12pt">Exception{</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//给image字节流赋值</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           String fileRealPath = ServletActionContext.</span><span style="font-size:12pt"><i>getServletContext</i></span><span style="font-size:12pt">().getRealPath(</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt">&quot;/WEB-INF/classes/霉女.jpg&quot;</span></font> <font face="Consolas"><span style="font-size:12pt">);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">filename</span></font> <font face="Consolas"><span style="font-size:12pt">= FilenameUtils.</span> <span style="font-size:12pt"><i>getName</i></span><span style="font-size:12pt">(fileRealPath);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//方式一：中文文件要进行URL编码</span></font></div><div align="left"><font color="#3F7F5F" face="Consolas"><span style="font-size:12pt">//         filename = URLEncoder.encode(filename, &quot;UTF-8&quot;);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">filesize</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>new</b></span></font> <font face="Consolas"><span style="font-size:12pt">File(fileRealPath).length();</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           System.</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>out</i></span></font><font face="Consolas"><span style="font-size:12pt">.println(</span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">filename</span></font><font face="Consolas"><span style="font-size:12pt">);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt">image</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>new</b></span></font> <font face="Consolas"><span style="font-size:12pt">FileInputStream(fileRealPath);</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#7F0055" face="Consolas"><span style="font-size:12pt"><b>return</b></span></font> <font color="#0000C0" face="Consolas"><span style="font-size:12pt"><i>SUCCESS</i></span></font><font face="Consolas"><span style="font-size:12pt">;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     }</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">}</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt"><br/></span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt"><br/></span></font></div><div align="left"><div align="left"><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">package</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font><font face="Consolas"><span style="font-size:12pt">=</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;p1&quot;</i></span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">extends</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;struts-default&quot;</i></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">action</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;download&quot;</i></span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">class</span></font><font face="Consolas"><span style="font-size:12pt">=</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;com.itheima.actions.DownloadAction&quot;</i></span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">method</span></font><font face="Consolas"><span style="font-size:12pt">=</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;download&quot;</i></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">result</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">type</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;stream&quot;</i></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                     </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">param</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font> <font face="Consolas"><span style="font-size:12pt">=</span></font><font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;inputName&quot;</i></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font><font face="Consolas"><span style="font-size:12pt">image</span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font> <font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">param</span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                     </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">param</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font><font face="Consolas"><span style="font-size:12pt">=</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;contentType&quot;</i></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font><font face="Consolas"><span style="font-size:12pt">application/</span><span style="font-size:12pt"><u>octet</u></span><span style="font-size:12pt">-stream</span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font> <font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">param</span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                     </span></font> <font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">&lt;!-- 在struts.xml中使用OGNL表达式获取动作类中属性的值。 调用动作类中的 getFilename()--&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                     </span></font> <font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">&lt;!-- 中文文件名编码:方式二.使用OGNL表达式,调用URLEncode的静态方法 --&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                     </span></font> <font color="#3F5FBF" face="Consolas"><span style="font-size:12pt">&lt;!-- 默认OGNL调用静态方法是不行的,需要开启一个常量开关.struts.ognl.allowStaticMethodAccess=true --&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                     </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">param</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font><font face="Consolas"><span style="font-size:12pt">=</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;contentDisposition&quot;</i></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font><font face="Consolas"><span style="font-size:12pt">attachment;filename=${@java.net.URLEncoder@encode(filename,'UTF-8')}</span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">param</span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                     </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">param</span></font> <font color="#7F007F" face="Consolas"><span style="font-size:12pt">name</span></font><font face="Consolas"><span style="font-size:12pt">=</span></font> <font color="#2A00FF" face="Consolas"><span style="font-size:12pt"><i>&quot;contentLength&quot;</i></span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font><font face="Consolas"><span style="font-size:12pt">${</span><span style="font-size:12pt"><u>filesize</u></span><span style="font-size:12pt">}</span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font> <font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">param</span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">                </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">result</span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">           </span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">action</span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div><div align="left"><font face="Consolas"><span style="font-size:12pt">     </span></font><font color="#008080" face="Consolas"><span style="font-size:12pt">&lt;/</span></font><font color="#3F7F7F" face="Consolas"><span style="font-size:12pt">package</span></font> <font color="#008080" face="Consolas"><span style="font-size:12pt">&gt;</span></font></div></div></div><div style="font-size: 32px;"><b>四、OGNL表达式简介</b></div><div style="font-size: 19px;"><b>1).</b>OGNL是Object Graphic Navigation Language（对象图导航语言）的缩写，</div><div style="font-size: 19px;">它是一个开源项目。 Struts2框架使用OGNL作为默认的表达式语言。<br/>
OGNL相对其它表达式语言具有下面几大优势：<br/>
   1、支持对象方法调用，如xxx.doSomeSpecial()；<br/>
   2、支持类静态的方法调用和值访问，表达式的格式:<br/>
      @[类全名（包括包路径）]@[方法名 |  值名]，例如：<br/>
             @java.lang.String@format('foo %s', 'bar')<br/>
             或@tutorial.MyConstant@APP_NAME；<br/>
      设置 struts.ognl.allowStaticMethodAccess=true<br/>
   3、支持赋值操作和表达式串联，如price=100, discount=0.8,<br/>
        calculatePrice()，这个表达式会返回80；<br/>
   4、访问OGNL上下文（OGNL context）和ActionContext；<br/>
   5、操作集合对象。<br/>
Ognl 有一个上下文（Context）概念，说白了上下文就是一个MAP结构，它实现<br/>
了java.utils.Map的接口.</div><div style="font-size: 32px;"><img src="struts基础3(包含文件上传下载)_files/Image [17].png" type="image/png" height="131" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="664"/></div><div style="font-size: 32px;"><b>五、ValueStack和ActionContext（很重要）</b></div><div style="font-size: 32px;"><img src="struts基础3(包含文件上传下载)_files/Image [18].png" type="image/png" height="480" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="800"/></div><div style="font-size: 24px;">1.Struts2中的 ValueStack </div><div><span style="font-size: 19px;">ValueStack实际是一个接口,在Struts2中利用OGNL时，实际上使用的是实现了该接口的OgnlValueStack类,这个类是Struts2利用OGNL的基础 </span><br/></div><div><span style="font-size: 19px;">ValueStack(值栈): 贯穿整个 Action 的生命周期(每个 Action 类的对象实例都拥有一个</span><span style="font-size: 19px;"> ValueStack 对象). 相当于一个数据的中转站. 在其中保存当前</span><span style="font-size: 19px;"> Action 对象和其他相关对象.</span><br style="font-size: 19px;"/><span style="font-size: 19px;">Struts 框架把 ValueStack 对象保存在名为 “struts.valueStack” 的请求属性中,并将</span><span style="font-size: 19px;">struts.valueStack封装在</span><span style="font-size: 19px;">request中</span></div><div><font color="#E30000"><span style="font-size: 19px;">在 ValueStack 对象的内部有两个逻辑部分:</span><br style="font-size: 19px;"/></font></div></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div><span style="font-size: 19px;"><font color="#E30000">ObjectStack: Struts  把动作和相关对象压入 ObjectStack 中--实现了栈结构的List</font></span></div><div><span style="font-size: 19px;"><font color="#E30000">ContextMap: Struts 把各种各样的映射关系(一些 Map 类型的对象) 压入 ContextMap 中</font></span></div></blockquote><div><span style="font-size: 19px;">Struts 会把下面这些映射压入 ContextMap 中</span><br style="font-size: 19px;"/></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div><span style="font-size: 19px;">parameters: 该 Map 中包含当前请求的请求参数</span></div><div><span style="font-size: 19px;">request: 该 Map 中包含当前 request 对象中的所有属性</span></div><div><span style="font-size: 19px;">session: 该 Map 中包含当前 session 对象中的所有属性</span></div><div><span style="font-size: 19px;">application:该 Map 中包含当前 application  对象中的所有属性</span></div><div><span style="font-size: 19px;">attr: 该 Map 按如下顺序来检索某个属性: request, session, application</span></div><div><img src="struts基础3(包含文件上传下载)_files/Image [19].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><span style="font-size: 21px;">ActionContext提供了对ognl上下文对象中数据操作的方法.</span><br/></div><div style="font-size: 21px;"><img src="struts基础3(包含文件上传下载)_files/Image [20].png" type="image/png" height="533" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="800"/></div><div style="font-size: 21px;"><img src="struts基础3(包含文件上传下载)_files/ValueStack和ActionContext关系简图.png" type="image/png" height="533" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="800"/></div></blockquote><div><span style="font-family: 宋体;"><span style="font-size: 19px;">2</span><font face="宋体" style="font-size: 19px;">、</font><font face="Times New Roman" style="font-size: 19px;">ValueStack</font><font face="宋体" style="font-size: 19px;">中的的常用方法：功能一定要知道干什么的。</font></span></div><div><img src="struts基础3(包含文件上传下载)_files/Image [21].png" type="image/png" height="452" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="343"/></div><div style="font-size: 16px;">getContext():返回的是一个Map&lt;String,Object&gt;（为contextMap）<br/>
*getRoot():返回的是一个CompoundRoot。<br/>
CompoundRoot就是一个ArrayList的子类（就是一个List）。实现了一个栈结构<br/><br/>
CompoundRoot():默认的构造方法。实际就是创建一个List集合<br/>
CompoundRoot(List):用一个集合来初始化一个CompoundRoot对象<br/>
cutStack(int):按照集合中的索引，剪出一个新的List集合<br/>
peek():取集合中的第一个元素。get(0)<br/>
pop():从集合中删除第一个元素<br/>
push(Object):向集合中的第一个元素位置插入数据<br/>
peek():CompoundRoot中的第一个元素。get(0)<br/>
pop():从CompoundRoot集合中删除第一个元素<br/>
push(Object):向CompoundRoot集合中的第一个元素位置插入数据<br/>
size():获取 CompoundRoot这个集合的大小<br/>
setValue(String,Object):第一个参数，是OGNL表达式。向自己（getContext()）得到那个Map中尝试放东西。<br/>
setParameter(String,Object):第一个参数，是OGNL表达式。向自己（getContext()）得到那个Map中尝试放东西。<br/>
findString(String expr):返回的是一个String类型的，否则报错.第一个参数，是OGNL表达式。<br/>
findValue():返回的是一个Object。第一个参数，是OGNL表达式。</div><div><span style="font-size: 32px;">3、ActionContext</span><br/><br style="font-size: 19px;"/><span style="font-size: 19px;">static ThreadLocal&lt;ActionContext&gt; actionContext = new ThreadLocal&lt;ActionContext&gt;();</span><br style="font-size: 19px;"/><span style="font-size: 19px;">每个线程都会有唯一的ActionContext，且一个线程中只有一个ActionContext。</span></div><div><img src="struts基础3(包含文件上传下载)_files/Image [22].png" type="image/png" height="501" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="321"/></div><div><p style="margin-bottom: 0pt; margin-top: 0pt; font-size: 16px;"><span style="font-family: 宋体;">getApplication():<font face="宋体">返回的是一个</font><font face="Times New Roman">Map</font></span></p><p style="margin-bottom: 0pt; margin-top: 0pt; font-size: 16px;"><span style="font-family: 宋体;">getContext():<font face="宋体">放回的当前线程上的</font><font face="Times New Roman">ActionContext</font><font face="宋体">对象</font></span></p><p style="margin-bottom: 0pt; margin-top: 0pt; font-size: 16px;"><span style="font-family: 宋体;">getContextMap():<font face="宋体">返回</font><font face="Times New Roman">ActionContext</font><font face="宋体">中的那一个</font><font face="Times New Roman">Map</font></span></p><p style="margin-bottom: 0pt; margin-top: 0pt; font-size: 16px;"><span style="font-family: 宋体;">getParameters():<font face="宋体">返回的是一个</font><font face="Times New Roman">Map</font></span></p><p style="margin-bottom: 0pt; margin-top: 0pt; font-size: 16px;"><span style="font-family: 宋体;">getSession():<font face="宋体">返回的是一个</font><font face="Times New Roman">Map</font></span></p><p style="margin-bottom: 0pt; margin-top: 0pt; font-size: 16px;"><span style="font-family: 宋体;">getValueStack():<font face="宋体">返回的是当前线程中的</font><font face="Times New Roman">ValueStack</font><font face="宋体">实例</font></span></p><div><span style="font-family: 宋体;">get(String):<font face="宋体">从</font><font face="Times New Roman">ActionContext</font><font face="宋体">的</font><font face="Times New Roman">Map</font><font face="宋体">中获取数据</font></span></div></div><div style="font-size: 24px;"><span style="font-family: 宋体;"><font face="宋体"><b>4、ServletActionContext：决定contextMap中会存放哪些数据</b></font></span></div><div><p style="margin-bottom: 0pt; margin-top: 0pt; font-size: 21px;"><span style="background-color: rgb(192, 192, 192); font-family: 宋体;">总结：都是从<font face="Consolas">ActionContext</font><font face="宋体">的那个大</font><font face="Consolas">Map</font><font face="宋体">中获取的。</font></span></p></div><div><img src="struts基础3(包含文件上传下载)_files/Image [23].png" type="image/png" height="312" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="330"/></div><div style="font-size: 24px;">5、在执行动作方法前，contextMap中放了以下东西在contextMap中</div><div style="font-size: 24px;"><table style="border-collapse:collapse; width:426.1000pt; mso-table-layout-alt:fixed; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;"><tbody><tr><td style="width:142.0000pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:0.5000pt solid rgb(0,0,0); mso-border-left-alt:0.5000pt solid rgb(0,0,0); border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:0.5000pt solid rgb(0,0,0); mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体';">key</span></p></td><td style="width:142.0500pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:none; ; mso-border-left-alt:none; ; border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:0.5000pt solid rgb(0,0,0); mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体';">value</span></p></td><td style="width:142.0500pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:none; ; mso-border-left-alt:none; ; border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:0.5000pt solid rgb(0,0,0); mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体';">备注</span></p></td></tr><tr><td style="width:142.0000pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:0.5000pt solid rgb(0,0,0); mso-border-left-alt:0.5000pt solid rgb(0,0,0); border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; color:rgb(42,0,255); font-size:12.0000pt; background:rgb(255,255,255); mso-highlight:rgb(255,255,255); font-family:'Consolas';">request</span></p></td><td style="width:142.0500pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:none; ; mso-border-left-alt:none; ; border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体';">ServletRequest<font face="宋体">中的那个</font><font face="Times New Roman">Map</font></span></p></td><td style="width:142.0500pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:none; ; mso-border-left-alt:none; ; border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="font-size:10.5000pt; font-family:'宋体';"> </span></p></td></tr><tr><td style="width:142.0000pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:0.5000pt solid rgb(0,0,0); mso-border-left-alt:0.5000pt solid rgb(0,0,0); border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; color:rgb(42,0,255); font-size:12.0000pt; background:rgb(255,255,255); mso-highlight:rgb(255,255,255); font-family:'Consolas';">session</span></p></td><td style="width:142.0500pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:none; ; mso-border-left-alt:none; ; border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体';">HttpSession<font face="宋体">中的那个</font><font face="Times New Roman">Map</font></span></p></td><td style="width:142.0500pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:none; ; mso-border-left-alt:none; ; border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="font-size:10.5000pt; font-family:'宋体';"> </span></p></td></tr><tr><td style="width:142.0000pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:0.5000pt solid rgb(0,0,0); mso-border-left-alt:0.5000pt solid rgb(0,0,0); border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; color:rgb(42,0,255); font-size:12.0000pt; background:rgb(255,255,255); mso-highlight:rgb(255,255,255); font-family:'Consolas';">application</span></p></td><td style="width:142.0500pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:none; ; mso-border-left-alt:none; ; border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体';">ServletContext<font face="宋体">中的那个</font><font face="Times New Roman">Map</font></span></p></td><td style="width:142.0500pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:none; ; mso-border-left-alt:none; ; border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="font-size:10.5000pt; font-family:'宋体';"> </span></p></td></tr><tr><td style="width:142.0000pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:0.5000pt solid rgb(0,0,0); mso-border-left-alt:0.5000pt solid rgb(0,0,0); border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; color:rgb(42,0,255); font-size:12.0000pt; background:rgb(255,255,255); mso-highlight:rgb(255,255,255); font-family:'Consolas';">parameters</span></p></td><td style="width:142.0500pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:none; ; mso-border-left-alt:none; ; border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体';">请求参数<font face="Times New Roman">Map&lt;String,String[]&gt;</font></span></p></td><td style="width:142.0500pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:none; ; mso-border-left-alt:none; ; border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="font-size:10.5000pt; font-family:'宋体';"> </span></p></td></tr><tr><td style="width:142.0000pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:0.5000pt solid rgb(0,0,0); mso-border-left-alt:0.5000pt solid rgb(0,0,0); border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; color:rgb(42,0,255); font-size:12.0000pt; background:rgb(255,255,255); mso-highlight:rgb(255,255,255); font-family:'Consolas';">attr</span></p></td><td style="width:142.0500pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:none; ; mso-border-left-alt:none; ; border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体';">也是一个</span><span style="font-size: 12pt; background-color: rgb(192, 192, 192); font-family: Consolas; background-position: initial initial; background-repeat: initial initial;">AttributeMap</span></p></td><td style="width:142.0500pt; padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ; border-left:none; ; mso-border-left-alt:none; ; border-right:0.5000pt solid rgb(0,0,0); mso-border-right-alt:0.5000pt solid rgb(0,0,0); border-top:none; ; mso-border-top-alt:0.5000pt solid rgb(0,0,0); border-bottom:0.5000pt solid rgb(0,0,0); mso-border-bottom-alt:0.5000pt solid rgb(0,0,0);" valign="top" width="189"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:'yes'; font-size:10.5000pt; font-family:'宋体';">获取数据依次从<font face="Times New Roman">contextMap</font><font face="宋体">中的</font><font face="Times New Roman">requestMap</font><font face="宋体">、</font><font face="Times New Roman">sessionMap</font><font face="宋体">、</font><font face="Times New Roman">applicationMap</font><font face="宋体">中搜索</font></span></p></td></tr></tbody></table></div><div style="font-size: 32px;"><hr/><hr/></div><div style="font-size: 32px;"><b>六、防止表单重复提交</b></div><div><br/></div><div><img src="struts基础3(包含文件上传下载)_files/Image [24].png" type="image/png" height="495" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="1046"/></div><div><br/></div><div><b><br/></b></div><div style="font-size: 32px;"><b>九、Struts与Spring的整合</b></div><div style="font-size: 32px;"><b><br/></b></div><div style="font-size: 32px;"><b><br/></b></div><div style="font-size: 32px;"><b>十、Struts的综合案例：CRUD</b></div></div>
</div></body></html> 