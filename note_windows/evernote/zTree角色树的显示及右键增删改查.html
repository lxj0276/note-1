<html>
<head>
  <title>zTree角色树的显示及右键增删改查</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/272236; Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="6504"/>
<h1>zTree角色树的显示及右键增删改查</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2014/8/29 12:33</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2014/8/29 21:15</i></td></tr>
</table>
</div>
<br/>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div style="font-size: 24px;">一、树的显示</div><div style="font-size: 24px;">1<font face="宋体">、在</font><font face="Times New Roman">pom.xml</font><font face="宋体">文件中，引入坐标</font></div><div><p style="margin-bottom: 0pt; margin-top: 0pt;"><span style="font-size: 10.5pt;"> </span>  &lt;dependency&gt;</p><p style="margin-bottom: 0pt; margin-top: 0pt;">          &lt;groupId&gt;org.apache.struts&lt;/groupId&gt;</p><p style="margin-bottom: 0pt; margin-top: 0pt;">          &lt;artifactId&gt;struts2-json-plugin&lt;/artifactId&gt;</p><p style="margin-bottom: 0pt; margin-top: 0pt;">          &lt;version&gt;2.3.1.2&lt;/version&gt;</p><p style="margin-bottom: 0pt; margin-top: 0pt;">   &lt;/dependency&gt;</p></div><div>     需要的jar包：<img src="zTree角色树的显示及右键增删改查_files/Image.png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><br/></div><div style="font-size: 24px;">2.再role.xml中自定义的包要继承json-default</div><div style="font-size: 24px;">在json-default包中声明了一个结果集，及几个拦截器</div><div><img src="zTree角色树的显示及右键增删改查_files/Image [1].png" type="image/png" height="550" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="1316"/></div><div><div><span style="mso-spacerun:&amp;amp;amp;amp;apos;yes&amp;amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;amp;apos;宋体&amp;amp;amp;amp;apos;;"><br/></span></div><div style="font-size: 24px;">3<font face="宋体">、通过</font><font face="Times New Roman">hibernate,</font><font face="宋体">给</font><font face="Times New Roman">role</font><font face="宋体">表赋值</font></div><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:&amp;amp;amp;amp;apos;yes&amp;amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;amp;apos;宋体&amp;amp;amp;amp;apos;;">         通过 <font face="Times New Roman">RoleTest.java</font><font face="宋体">给</font><font face="Times New Roman">role</font><font face="宋体">表中赋值</font></span></p></div><div style="font-size: 24px;">4<font face="宋体">、在</font><font face="Times New Roman">system/role/role.jsp</font><font face="宋体">中显示树</font></div><div><font face="宋体">     </font><span style="font-size: 10.5pt;">1</span><font face="宋体" style="font-size: 10.5pt;">、把树的样式导入到项目中</font><font face="Times New Roman" style="font-size: 10.5pt;">zTreeStyle</font></div><div><font face="Times New Roman" style="font-size: 10.5pt;">               </font><img src="zTree角色树的显示及右键增删改查_files/Image [2].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div>     <span style="font-size: 10.5pt;">2</span><font face="宋体" style="font-size: 10.5pt;">、在</font><font face="Times New Roman" style="font-size: 10.5pt;">common.jsp</font><font face="宋体" style="font-size: 10.5pt;">中，增加树的样式</font></div><div><font face="宋体" style="font-size: 10.5pt;">     </font><img src="zTree角色树的显示及右键增删改查_files/Image [3].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div><br/></div><div>     <span style="font-size: 10.5pt;">3</span><font face="宋体" style="font-size: 10.5pt;">、在</font><font face="Times New Roman" style="font-size: 10.5pt;">js</font><font face="宋体" style="font-size: 10.5pt;">文件夹中，增加</font><font face="Times New Roman" style="font-size: 10.5pt;">jquery-ztree-2.5.js</font><font face="宋体" style="font-size: 10.5pt;">文件</font></div><div><br/></div><div><img src="zTree角色树的显示及右键增删改查_files/Image [4].png" type="image/png" height="67" style="cursor: default;cursor: default;cursor: default;" width="255"/></div><div>     <span style="font-size: 10.5pt;"> 4</span><font face="宋体" style="font-size: 10.5pt;">、在</font><font face="Times New Roman" style="font-size: 10.5pt;">role.jsp</font><font face="宋体" style="font-size: 10.5pt;">中，准备树的容器</font></div><div><font face="宋体" style="font-size: 10.5pt;">     </font><img src="zTree角色树的显示及右键增删改查_files/Image [5].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div>     <span style="font-size: 10.5pt;">5</span><font face="宋体" style="font-size: 10.5pt;">、准备</font><font face="Times New Roman" style="font-size: 10.5pt;">RoleAction</font></div><div>     <img src="zTree角色树的显示及右键增删改查_files/Image [6].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div>     <span style="font-size: 10.5pt;">6</span><font face="宋体" style="font-size: 10.5pt;">、写</font><font face="Times New Roman" style="font-size: 10.5pt;">struts2</font><font face="宋体" style="font-size: 10.5pt;">的配置文件</font></div><div><font face="宋体" style="font-size: 10.5pt;">     </font><img src="zTree角色树的显示及右键增删改查_files/Image [7].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div>     <span style="font-size: 10.5pt;">7</span><font face="宋体" style="font-size: 10.5pt;">、写一个</font><font face="Times New Roman" style="font-size: 10.5pt;">action:ForwardAction：用于转到role.jsp页面，并用ajax加载树（因为jsp在WIN-INF下，无法自动访问）</font></div><div><font face="Times New Roman" style="font-size: 10.5pt;">     </font><img src="zTree角色树的显示及右键增删改查_files/Image [8].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div>     <span style="font-size: 10.5pt;">8</span><font face="宋体" style="font-size: 10.5pt;">、写关于</font><font face="Times New Roman" style="font-size: 10.5pt;">forward</font><font face="宋体" style="font-size: 10.5pt;">的配置文件</font></div><div><font face="宋体" style="font-size: 10.5pt;">     </font><img src="zTree角色树的显示及右键增删改查_files/Image [9].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/>     </div><div>     9.<span style="font-size: 10.5pt;">9</span><font face="宋体" style="font-size: 10.5pt;">、编写</font><font face="Times New Roman" style="font-size: 10.5pt;">js</font><font face="宋体" style="font-size: 10.5pt;">文件  </font><font face="Times New Roman" style="font-size: 10.5pt;">js/role.js</font><font face="宋体" style="font-size: 10.5pt;">文件</font></div><div><font face="宋体" style="font-size: 10.5pt;">           </font><img src="zTree角色树的显示及右键增删改查_files/Image [10].png" type="image/png" height="755" style="cursor: default;cursor: default;cursor: default;" width="956"/></div><div><hr/><hr/></div><div style="font-size: 24px;">二.角色的右键菜单</div><div style="font-size: 24px;"><span style="mso-spacerun:&amp;amp;amp;amp;apos;yes&amp;amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;amp;apos;宋体&amp;amp;amp;amp;apos;;">1<font face="宋体">、在</font><font face="Times New Roman">role.js</font><font face="宋体">中添加如下黄色部分的代码：</font></span></div><div style="font-size: 24px;"><img src="zTree角色树的显示及右键增删改查_files/Image [11].png" type="image/png" style="cursor: default;"/></div><div style="font-size: 24px;"><img src="zTree角色树的显示及右键增删改查_files/Image [12].png" type="image/png" height="481" style="cursor: default;cursor: default;cursor: default;" width="916"/></div><div style="font-size: 24px;"><div><span style="mso-spacerun:&amp;amp;amp;amp;apos;yes&amp;amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;amp;apos;宋体&amp;amp;amp;amp;apos;;"> 2<font face="宋体">、在</font><font face="Times New Roman">role.jsp</font><font face="宋体">中添加右键菜单</font></span></div></div><div style="font-size: 24px;"><img src="zTree角色树的显示及右键增删改查_files/Image [13].png" type="image/png" height="365" style="cursor: default;cursor: default;cursor: default;" width="993"/></div><div style="font-size: 24px;"><div><span style="mso-spacerun:&amp;amp;amp;amp;apos;yes&amp;amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;amp;apos;宋体&amp;amp;amp;amp;apos;;">3<font face="宋体">、在</font><font face="Times New Roman">role.js</font><font face="宋体">中</font></span></div></div><div style="font-size: 24px;"><img src="zTree角色树的显示及右键增删改查_files/Image [14].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div style="font-size: 15px;">4.在role.js中建立与data平级的init，在其中建立initEvent方法，放入下边的hover代码</div><div style="font-size: 24px;"><img src="zTree角色树的显示及右键增删改查_files/Image [15].png" type="image/png" style="cursor: default;"/></div><div style="font-size: 24px;"><hr/><hr/>
三.角色的增加</div><div style="font-size: 24px;"><span style="mso-spacerun:&amp;amp;amp;amp;apos;yes&amp;amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;amp;apos;宋体&amp;amp;amp;amp;apos;;">1<font face="宋体">、添加增加角色事件</font></span></div><div style="font-size: 24px;"><img src="zTree角色树的显示及右键增删改查_files/Image [16].png" type="image/png" style="cursor: default;cursor: default;"/></div><div style="font-size: 24px;"><div><span style="mso-spacerun:&amp;amp;amp;apos;yes&amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;apos;宋体&amp;amp;amp;apos;;">2<font face="宋体">、在</font><font face="Times New Roman">role.js</font><font face="宋体">中，准备数据</font></span></div></div><div style="font-size: 24px;"><img src="zTree角色树的显示及右键增删改查_files/Image [17].png" type="image/png" style="cursor: default;cursor: default;"/></div><div style="font-size: 24px;"><div><span style="mso-spacerun:&amp;amp;amp;apos;yes&amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;apos;宋体&amp;amp;amp;apos;;">3<font face="宋体">、在点击右键菜单的时候，把当前点击的节点赋值给</font><font face="Times New Roman">roleNode</font></span></div></div><div style="font-size: 24px;"><img src="zTree角色树的显示及右键增删改查_files/Image [18].png" type="image/png" style="cursor: default;cursor: default;"/></div><div style="font-size: 24px;"><div><span style="mso-spacerun:&amp;amp;amp;apos;yes&amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;apos;宋体&amp;amp;amp;apos;;">4<font face="宋体">、在</font><font face="Times New Roman">role.js</font><font face="宋体">中,</font></span><span style="font-size: 10.5pt;"> addRole</span><font face="宋体" style="font-size: 10.5pt;">方法完成添加操作</font></div></div><div style="font-size: 15px;"><img src="zTree角色树的显示及右键增删改查_files/Image [19].png" type="image/png" style="cursor: default;"/></div><div><hr style="font-size: 15px;"/><hr style="font-size: 15px;"/><h2 style="margin-bottom: 0pt; margin-top: 0pt; font-size: 32px;"><font size="3" style="font-size: 24px; font-weight: normal;">四.角色的修改</font></h2></div><div style="font-size: 24px;"><span style="mso-spacerun:&amp;amp;amp;apos;yes&amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;apos;宋体&amp;amp;amp;apos;;">1<font face="宋体">、增加一个修改事件</font></span></div><div style="font-size: 24px;"><img src="zTree角色树的显示及右键增删改查_files/Image [20].png" type="image/png" style="cursor: default;"/></div><div style="font-size: 24px;"><p style="margin-bottom:0pt; margin-top:0pt;"><span style="mso-spacerun:&amp;amp;amp;apos;yes&amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;apos;宋体&amp;amp;amp;apos;;">2<font face="宋体">、完成</font><font face="Times New Roman">updateRole</font><font face="宋体">方法</font></span></p></div><div style="font-size: 24px;"><span style="mso-spacerun:&amp;amp;amp;apos;yes&amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;apos;宋体&amp;amp;amp;apos;;"><font face="宋体">     </font></span><span style="font-size: 10.5pt;">  1</span><font face="宋体" style="font-size: 10.5pt;">、获取到要修改的节点的名称，在</font><font face="Times New Roman" style="font-size: 10.5pt;">window.prompt</font><font face="宋体" style="font-size: 10.5pt;">中进行</font><span style="font-size: 10.5pt;">回显</span></div><div style="font-size: 24px;"><span style="font-size: 10.5pt;">           2</span><font face="宋体" style="font-size: 10.5pt;">、获取到修改后的名称，判断是否有同名的，如果有，则提示,</font><span style="font-size: 10.5pt;"> 如果没有，则进行修改</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div><p style="font-size: 24px; margin-bottom: 0pt; margin-top: 0pt;"><span style="mso-spacerun:&amp;amp;amp;apos;yes&amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;apos;宋体&amp;amp;amp;apos;;"> 3<font face="宋体">、当后台成功的修改以后，前台必须刷新，树的节点的名称才能</font></span><span style="font-size: 10.5pt;">改变。</span></p></div></blockquote><div style="font-size: 24px;"><img src="zTree角色树的显示及右键增删改查_files/Image [21].png" type="image/png" style="cursor: default;cursor: default;"/></div><div style="font-size: 24px;"><hr/><hr/>
五.<span style="font-size: 16pt;">角色的删除</span></div><div><span style="mso-spacerun:&amp;amp;amp;apos;yes&amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;apos;宋体&amp;amp;amp;apos;;">1<font face="宋体">、添加删除的事件<br/></font></span><img src="zTree角色树的显示及右键增删改查_files/Image [22].png" type="image/png" style="cursor: default;cursor: default;"/></div><div><span style="mso-spacerun:&amp;amp;amp;apos;yes&amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;apos;宋体&amp;amp;amp;apos;;">2<font face="宋体">、</font><font face="Times New Roman">deleteRole</font><font face="宋体">方法</font></span></div><div><img src="zTree角色树的显示及右键增删改查_files/Image [23].png" type="image/png" height="481" style="cursor: default;cursor: default;" width="1084"/></div><div style="font-size: 24px;"><span style="mso-spacerun:&amp;amp;amp;apos;yes&amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;apos;宋体&amp;amp;amp;apos;;"><font face="宋体"><br/></font></span></div><div style="font-size: 24px;"><span style="mso-spacerun:&amp;amp;amp;apos;yes&amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;apos;宋体&amp;amp;amp;apos;;"><font face="宋体"><br/></font></span></div><div style="font-size: 24px;"><span style="mso-spacerun:&amp;amp;amp;apos;yes&amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;apos;宋体&amp;amp;amp;apos;;"><font face="宋体"><br/></font></span></div><div style="font-size: 24px;"><span style="mso-spacerun:&amp;amp;amp;apos;yes&amp;amp;amp;apos;; font-size:10.5000pt; font-family:&amp;amp;amp;apos;宋体&amp;amp;amp;apos;;"><font face="宋体"><br/></font></span></div></div>
</div></body></html> 