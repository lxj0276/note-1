<html>
<head>
  <title>注解</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/272236; Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="1541"/>
<h1>注解</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2014/7/21 14:32</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2014/7/22 0:29</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="mk:@MSITStore:F:\资料\API\jdk-8-apidocs.chm::/api/java/lang/reflect/AnnotatedElement.html"><i>mk:@MSITStore:F:\资料\API\jdk-8-apidocs.chm::/api/java/lang/reflect/AnnotatedElement.html</i></a></td></tr>
</table>
</div>
<br/>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><span style="font-size: 32px;"><b>一、注解的定义</b></span><div><span style="font-size: 21px;">1、从 JDK 5.0 开始, Java 增加了对元数据(MetaData) 的支持, 也就是 Annotation(注解)。</span><br/></div><div><span style="font-size: 21px;">什么是Annotation，以及注解的作用?三个基本的 Annotation:</span><br/></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style="font-size: 19px;">@Override: 限定重写父类方法, 该注解只能用于方法</div><div style="font-size: 19px;">@Deprecated: 用于表示某个程序元素(类, 方法等)已过时</div><div style="font-size: 19px;">@SuppressWarnings: 抑制编译器警告. </div></blockquote><div style="font-size: 21px;">Annotation 其实就是代码里的特殊标记, 它用于替代配置文件；<font color="#41AD1C">传统方式</font>通过<font color="#41AD1C">配置文件告诉类如何运行</font>，有了注解技术后，开发人员可以<font color="#41AD1C">通过注解告诉类如何运行</font>。在<font color="#E30000">Java技术里注解的典型应用是：可以通过反射技术去得到类里面的注解，以决定怎么去运行类。</font></div><div style="font-size: 24px;">2、定义注解(注解本身不可以继承)</div><div style="font-size: 24px;"><font face="宋体" style="font-family: 宋体;">如何定义注解</font></div><div><font face="宋体"><span style="font-size: 14px;">     </span><span style="font-size: 21px;"> </span></font><span style="font-family: 宋体; font-size: 21px;">public @interface <font face="宋体">注解的名称</font><font face="Times New Roman">{}</font></span></div><div style="font-size: 21px;">声明注解的属性:</div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style="font-size: 19px;">注解属性的作用：原来写在配置文件中的信息，可以通过<font color="#41AD1C">注解的属性进行描述</font>。</div><div><span style="color: rgb(222, 87, 0); font-size: 19px;">Annotation 的属性声明方</span><font color="#FA7A00"><span style="font-size: 19px;">式：</span><span style="font-family: 宋体; text-indent: 28px; font-size: 19px;">类型 属性名称</span><font face="Times New Roman" style="text-indent: 28px; font-size: 19px;">() [default </font><font face="宋体" style="font-family: 宋体; text-indent: 28px; font-size: 19px;">默认值</font><font face="Times New Roman" style="text-indent: 28px; font-size: 19px;">];</font></font></div><div style="font-size: 19px;"><font color="#DE5700">                               String name();</font></div><div style="font-size: 19px;"><font color="#FA7A00">属性默认值声明方式：String name() default “xxx”;</font></div><div style="font-size: 19px;">特殊属性value：如果注解中有一个名称value的属性，那么使用注解时可以省略value=部分，如@MyAnnotation(“xxx&quot;)</div><div style="font-size: 24px;"><font color="#FF0000"><span style="text-indent: 21pt; font-family: 宋体;">特别注意：类型必须是基本类型、</span><font face="Times New Roman" style="text-indent: 21pt;">String</font><font face="宋体" style="text-indent: 21pt; font-family: 宋体;">、</font><font face="Times New Roman" style="text-indent: 21pt;">Class</font><font face="宋体" style="text-indent: 21pt; font-family: 宋体;">、注解类型、枚举及以上类型的一维数组。</font></font></div></blockquote><div><img src="注解_files/Image.png" type="image/png" height="580" style="cursor: default;cursor: default;cursor: default;cursor: default;" width="1256"/><b style="font-size: 32px;">二、注解的反射</b></div><div><span style="font-size: 21px;">1、java.lang.reflect  </span><span style="font-size: 24px;">Interface AnnotatedElement</span></div><div><div align="left" style="font-size: 24px;"><font color="#3F7F5F" face="Consolas"><span style="background-color: rgb(232, 242, 254);">所有定义的注解都是java.lang.annotation.Annotation的子类</span></font></div><div style="font-size: 21px;"><dl><dd><div><ul><li><dl><dt>All Known Implementing Classes:</dt><dd><a href="mk:java/lang/reflect/AccessibleObject.html" title="class in java.lang.reflect">AccessibleObject</a>, <a href="mk:java/lang/Class.html" title="class in java.lang">Class</a>, <a href="mk:java/lang/reflect/Constructor.html" title="class in java.lang.reflect">Constructor</a>, <a href="mk:java/lang/reflect/Executable.html" title="class in java.lang.reflect">Executable</a>, <a href="mk:java/lang/reflect/Field.html" title="class in java.lang.reflect">Field</a>, <a href="mk:java/lang/reflect/Method.html" title="class in java.lang.reflect">Method</a>, <a href="mk:java/lang/Package.html" title="class in java.lang">Package</a>, <a href="mk:java/lang/reflect/Parameter.html" title="class in java.lang.reflect">Parameter</a></dd></dl></li></ul></div></dd></dl></div><div><ul><li><ul><li><table border="0" cellpadding="3" cellspacing="0" style="font-size: 19px;" summary="Method Summary table, listing methods, and an explanation"><caption><br/></caption><tbody><tr><th>Modifier and Type</th><th>Method and Description</th></tr><tr><td><code>&lt;T extends <a href="mk:java/lang/annotation/Annotation.html" title="interface in java.lang.annotation">Annotation</a>&gt;<br/>
T</code></td><td><code><a href="mk:java/lang/reflect/AnnotatedElement.html#getAnnotation-java.lang.Class-">getAnnotation</a>(<a href="mk:java/lang/Class.html" title="class in java.lang">Class</a>&lt;T&gt; annotationClass)</code><div>Returns this element's annotation for the specified type if such an annotation is <em>present</em>, else null.</div></td></tr><tr><td><code><a href="mk:java/lang/annotation/Annotation.html" title="interface in java.lang.annotation">Annotation</a>[]</code></td><td><code><a href="mk:java/lang/reflect/AnnotatedElement.html#getAnnotations--">getAnnotations</a>()</code><div>Returns annotations that are <em>present</em> on this element.</div></td></tr><tr><td><code>default &lt;T extends <a href="mk:java/lang/annotation/Annotation.html" title="interface in java.lang.annotation">Annotation</a>&gt;<br/>
T[]</code></td><td><code><a href="mk:java/lang/reflect/AnnotatedElement.html#getAnnotationsByType-java.lang.Class-">getAnnotationsByType</a>(<a href="mk:java/lang/Class.html" title="class in java.lang">Class</a>&lt;T&gt; annotationClass)</code><div>Returns annotations that are <em>associated</em> with this element.</div></td></tr><tr><td><code>default &lt;T extends <a href="mk:java/lang/annotation/Annotation.html" title="interface in java.lang.annotation">Annotation</a>&gt;<br/>
T</code></td><td><code><a href="mk:java/lang/reflect/AnnotatedElement.html#getDeclaredAnnotation-java.lang.Class-">getDeclaredAnnotation</a>(<a href="mk:java/lang/Class.html" title="class in java.lang">Class</a>&lt;T&gt; annotationClass)</code><div>Returns this element's annotation for the specified type if such an annotation is <em>directly present</em>, else null.</div></td></tr><tr><td><code><a href="mk:java/lang/annotation/Annotation.html" title="interface in java.lang.annotation">Annotation</a>[]</code></td><td><code><a href="mk:java/lang/reflect/AnnotatedElement.html#getDeclaredAnnotations--">getDeclaredAnnotations</a>()</code><div>Returns annotations that are <em>directly present</em> on this element.</div></td></tr><tr><td><code>default &lt;T extends <a href="mk:java/lang/annotation/Annotation.html" title="interface in java.lang.annotation">Annotation</a>&gt;<br/>
T[]</code></td><td><code><a href="mk:java/lang/reflect/AnnotatedElement.html#getDeclaredAnnotationsByType-java.lang.Class-">getDeclaredAnnotationsByType</a>(<a href="mk:java/lang/Class.html" title="class in java.lang">Class</a>&lt;T&gt; annotationClass)</code><div>Returns this element's annotation(s) for the specified type if such annotations are either <em>directly present</em> or <em>indirectly present</em>.</div></td></tr><tr><td><code>default boolean</code></td><td><code><a href="mk:java/lang/reflect/AnnotatedElement.html#isAnnotationPresent-java.lang.Class-">isAnnotationPresent</a>(<a href="mk:java/lang/Class.html" title="class in java.lang">Class</a>&lt;? extends <a href="mk:java/lang/annotation/Annotation.html" title="interface in java.lang.annotation">Annotation</a>&gt; annotationClass)</code><div>Returns true if an annotation for the specified type is <em>present</em> on this element, else false.</div></td></tr></tbody></table></li></ul></li></ul></div><span style="font-size: 24px;"><br/>
2、元注解：</span></div><div style="font-size: 24px;">     <font face="宋体" style="font-family: 宋体; text-indent: 21pt;">只能用在注解上的注解，就是元注解。</font></div><div><span style="font-size: 24px;">     </span></div><div align="left"><p style="margin-bottom: 0pt; margin-top: 0pt; font-size: 24px;"><span style="font-family: 宋体;">3<font face="宋体">、注解的生命周期：</font></span></p></div><div align="left"><font face="Consolas"><span style="font-size: 19px;">   </span><span style="font-size: 24px;"><font color="#DE5700">3.1</font> </span></font><span style="font-size: 21px;"><font color="#FF0000">@Retention:</font> </span><span style="color: rgb(0, 0, 255); font-family: 宋体; text-indent: 21pt; font-size: 21px;">改变注解的生命周期.</span><span style="font-size: 21px;">只能用于修饰一个 Annotation 定义</span><span style="font-size: 21px;">，改变注解的生命周期。</span><span style="font-size: 19px;">@Rentention 包含一个 RetentionPolicy 类型的成员变量, 通过这个变量指定域。</span></div><div><div><span style="font-size: 19px;">          </span><span style="font-size: 19px;">  RetentionPolicy.CLASS: 编译器将把<font color="#E30000">注解记录在 class</font> 文件中. 当<font color="#41AD1C">运行 Java 程序时, JVM 不会保留注解. 这是默认值</font></span></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div style="font-size: 19px;">     RetentionPolicy.RUNTIME:编译器将把注释记录在 class 文件中. 当<font color="#41AD1C">运行 Java 程序时, JVM 会保留注解. 程序可以通过反射获取该注释</font></div><div style="font-size: 19px;">     RetentionPolicy.SOURCE: 编译器直接丢弃这种策略的注释</div><div style="font-size: 19px;"><img src="注解_files/01注解的生命周期.png" type="image/png" style="cursor: default;"/></div></blockquote><div><span style="font-size: 24px;">   <font color="#E30000"> 3.2 </font></span><span style="font-size: 21px;"><font color="#E30000">@Target：</font></span><span style="color: rgb(0, 0, 255); font-family: 宋体; text-indent: 21pt; font-size: 21px;">指示注解能用在何处</span><span style="font-size: 21px;">. @Target 包含了一个名为 value，类型为ElementType的成员变量。 </span></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px; font-size: 19px;"></blockquote><br/>
               <font color="#7F0055" face="Consolas" size="4"><span style="font-size: 14pt;"><b>public</b></span></font><font face="Consolas" size="4"> </font><font color="#7F0055" face="Consolas" size="4"><span style="font-size: 14pt;"><b>enum</b></span></font> <font face="Consolas" size="4"><span style="font-size: 14pt;">ElementType {</span></font><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size: 14pt;">/** Class, interface (including annotation type), or enum declaration */</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#0000C0" face="Consolas" size="4"><span style="font-size: 14pt;"><i>TYPE</i></span></font><font face="Consolas" size="4"><span style="font-size: 14pt;">,</span></font></div><div align="left"><font color="#010101" face="Consolas" size="4"><span style="font-size: 14pt;"><br/></span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size: 14pt;">/** Field declaration (includes enum constants) */</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#0000C0" face="Consolas" size="4"><span style="font-size: 14pt;"><i>FIELD</i></span></font><font face="Consolas" size="4"><span style="font-size: 14pt;">,</span></font></div><div align="left"><font color="#010101" face="Consolas" size="4"><span style="font-size: 14pt;"><br/></span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size: 14pt;">/** Method declaration */</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#0000C0" face="Consolas" size="4"><span style="font-size: 14pt;"><i>METHOD</i></span></font><font face="Consolas" size="4"><span style="font-size: 14pt;">,</span></font></div><div align="left"><font color="#010101" face="Consolas" size="4"><span style="font-size: 14pt;"><br/></span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size: 14pt;">/** Parameter declaration */</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#0000C0" face="Consolas" size="4"><span style="font-size: 14pt;"><i>PARAMETER</i></span></font><font face="Consolas" size="4"><span style="font-size: 14pt;">,</span></font></div><div align="left"><font color="#010101" face="Consolas" size="4"><span style="font-size: 14pt;"><br/></span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size: 14pt;">/** Constructor declaration */</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#0000C0" face="Consolas" size="4"><span style="font-size: 14pt;"><i>CONSTRUCTOR</i></span></font><font face="Consolas" size="4"><span style="font-size: 14pt;">,</span></font></div><div align="left"><font color="#010101" face="Consolas" size="4"><span style="font-size: 14pt;"><br/></span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size: 14pt;">/** Local variable declaration */</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#0000C0" face="Consolas" size="4"><span style="font-size: 14pt; background-color: rgb(212, 212, 212); background-position: initial initial; background-repeat: initial initial;"><i>LOCAL_VARIABLE</i></span></font><font face="Consolas" size="4"><span style="font-size: 14pt;">,</span></font></div><div align="left"><font color="#010101" face="Consolas" size="4"><span style="font-size: 14pt;"><br/></span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size: 14pt;">/** Annotation type declaration */</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#0000C0" face="Consolas" size="4"><span style="font-size: 14pt;"><i>ANNOTATION_TYPE</i></span></font><font face="Consolas" size="4"><span style="font-size: 14pt;">,</span></font></div><div align="left"><font color="#010101" face="Consolas" size="4"><span style="font-size: 14pt;"><br/></span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#3F5FBF" face="Consolas" size="4"><span style="font-size: 14pt;">/** Package declaration */</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">    </span></font><font color="#0000C0" face="Consolas" size="4"><span style="font-size: 14pt;"><i>PACKAGE</i></span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size: 14pt;">}</span></font></div></blockquote></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt"><br/></span></font></div>
  <span style="font-size: 24px;">   3.3  </span><span style="font-family: 宋体; text-indent: 21pt; font-size: 24px;">@Documented</span><font face="宋体" style="font-family: 宋体; text-indent: 21pt; font-size: 24px;">：注解是否出现在</font><font face="Times New Roman" style="text-indent: 21pt; font-size: 24px;">JavaDoc</font><font face="宋体" style="font-family: 宋体; text-indent: 21pt; font-size: 24px;">文档中</font><div><span style="font-family: 宋体; text-indent: 21pt; font-size: 24px;">   <b>3.4</b> @Inherited</span><font face="宋体" style="font-family: 宋体; text-indent: 21pt; font-size: 24px;">：使用了注解的类的子类是否自动拥有注解。</font><font face="宋体" style="font-family: 宋体; font-size: 10.5pt; text-indent: 21pt;"><br/></font><br/><br/><span style="font-size: 32px;">三、注解的一个应用，模拟@Test</span><br style="font-size: 32px;"/><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div><br/></div></blockquote><span style="font-size: 24px;">1、定义注解</span><br/><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>import</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">java.lang.annotation.ElementType;</span></font><br/><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>import</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">java.lang.annotation.Retention;</span></font><br/><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>import</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">java.lang.annotation.RetentionPolicy;</span></font><br/><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>import</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">java.lang.annotation.Target;</span></font><br/><font color="#010101" face="Consolas"><span style="font-size: 19px;"><br/></span></font><span style="font-size: 14pt; color: rgb(63, 127, 95); font-family: Consolas;">//要用反射，得加上@Retention(RetentionPolicy.RUNTIME)</span><br/><font color="#646464" face="Consolas" size="4"><span style="font-size:14pt">@Retention</span></font><font face="Consolas" size="4"><span style="font-size:14pt">(RetentionPolicy.</span></font><font color="#0000C0" face="Consolas" size="4"><span style="font-size:14pt"><i>RUNTIME</i></span></font><font face="Consolas" size="4"><span style="font-size:14pt">)</span></font><br/><span style="font-size: 14pt; color: rgb(63, 127, 95); font-family: Consolas;">//定义此注解只能在方法上用</span><br/><font color="#646464" face="Consolas" size="4"><span style="font-size:14pt">@Target</span></font><font face="Consolas" size="4"><span style="font-size:14pt">(ElementType.</span></font><font color="#0000C0" face="Consolas" size="4"><span style="font-size:14pt"><i>METHOD</i></span></font><font face="Consolas" size="4"><span style="font-size:14pt">)</span></font><br/><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>@interface</b></span></font> <font color="#646464" face="Consolas" size="4"><span style="font-size:14pt">MyTest</span></font> <font face="Consolas" size="4"><span style="font-size:14pt">{</span></font><br/><font face="Consolas" size="4"><span style="font-size:14pt">     </span></font><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>double</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">timeOut()</span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>default</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">-1;</span></font><br/><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">}</span></font></div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div><span style="font-size: 24px;">     </span></div></blockquote><span style="font-size: 24px;">     2、用反射来完成MyTest的功能</span><br/><span style="font-size: 24px;">     </span><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>import</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">java.lang.reflect.Method;</span></font><br/><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div align="left"><font color="#010101" face="Consolas" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>class</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">MyTestRunner {</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">     </span></font><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>static</b></span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>void</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">main(String[] args)</span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>throws</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">Exception{</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">          </span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">          </span></font> <font color="#3F7F5F" face="Consolas" size="4"><span style="font-size:14pt">//反射得到要测试类的所有方法</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">          Method[] methods = TestMyTestAnno.</span></font><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>class</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">.getMethods();</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">          </span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>for</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">(Method method : methods) {</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">              </span></font> <font color="#3F7F5F" face="Consolas" size="4"><span style="font-size:14pt">//Method</span> <span style="font-size:14pt"><u>ms</u></span> <span style="font-size:14pt">[] = clazz.getMethods();//判断方法上面有没有叫做@MyTest的注解</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">              </span></font> <font color="#3F7F5F" face="Consolas" size="4"><span style="font-size:14pt">//如果当前方法上面没有@MyTest注解，返回的是null</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">              </span></font> <font color="#646464" face="Consolas" size="4"><span style="font-size:14pt">MyTest</span></font> <font face="Consolas" size="4"><span style="font-size:14pt">myTest = method.getAnnotation(</span></font><font color="#646464" face="Consolas" size="4"><span style="font-size:14pt">MyTest</span></font> <font face="Consolas" size="4"><span style="font-size:14pt">.</span></font><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>class</b></span></font><font face="Consolas" size="4"><span style="font-size:14pt">);</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">              </span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>if</b></span></font><font face="Consolas" size="4"><span style="font-size:14pt">(myTest !=</span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>null</b></span></font><font face="Consolas" size="4"><span style="font-size:14pt">){</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">                   </span></font> <font color="#3F7F5F" face="Consolas" size="4"><span style="font-size:14pt">//执行该方法，判断是否超时</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">                   </span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>long</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">beganTime = System.</span><span style="font-size:14pt"><i>currentTimeMillis</i></span><span style="font-size:14pt">();</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">                   </span> <span style="font-size:14pt"><u>method.invoke(TestMyTestAnno.</u></span></font><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b><u>class</u></b></span></font><font face="Consolas" size="4"><span style="font-size:14pt"><u>.newInstance(),</u></span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b><u>null</u></b></span></font><font face="Consolas" size="4"><span style="font-size:14pt"><u>)</u></span><span style="font-size:14pt">;</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">                   </span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>long</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">useTime = System.</span><span style="font-size:14pt"><i>currentTimeMillis</i></span><span style="font-size:14pt">() - beganTime;</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">                   </span></font> <font color="#3F7F5F" face="Consolas" size="4"><span style="font-size:14pt">//获取注解上配置的timeout属性的值</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">                   </span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>long</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">planUserTime = (</span></font><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>long</b></span></font><font face="Consolas" size="4"><span style="font-size:14pt">) myTest.timeOut();</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">                   </span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>if</b></span></font><font face="Consolas" size="4"><span style="font-size:14pt">(planUserTime&gt;=0){</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">                        </span></font> <font color="#3F7F5F" face="Consolas" size="4"><span style="font-size:14pt">//说明用户指定了时间</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">                        </span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>if</b></span></font><font face="Consolas" size="4"><span style="font-size:14pt">(useTime&gt;planUserTime)</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">                             </span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>throw</b></span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>new</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">RuntimeException(</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:14pt">&quot;超时&quot;</span></font> <font face="Consolas" size="4"><span style="font-size:14pt">);</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">                   }</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">              }</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">     }</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">}</span></font></div></blockquote><div><span style="font-size: 24px;">     3、写一个测试注解的类</span></div><div><span style="font-size: 24px;">     </span><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>class</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">TestMyTestAnno {</span></font></div><div align="left"><font color="#010101" face="Consolas" size="4"><span style="font-size:14pt"><br/></span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">        </span></font><font color="#646464" face="Consolas" size="4">  <span style="font-size:14pt">@MyTest</span></font><font face="Consolas" size="4"><span style="font-size:14pt">(timeOut=1)</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">         </span></font><font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>public</b></span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>void</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">say()</span></font> <font color="#7F0055" face="Consolas" size="4"><span style="font-size:14pt"><b>throws</b></span></font> <font face="Consolas" size="4"><span style="font-size:14pt">InterruptedException{</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">                 Thread.</span> <span style="font-size:14pt"><i>sleep</i></span><span style="font-size:14pt">(2);</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">                 System.</span></font> <font color="#0000C0" face="Consolas" size="4"><span style="font-size:14pt"><i>out</i></span></font><font face="Consolas" size="4"><span style="font-size:14pt">.println(</span></font><font color="#2A00FF" face="Consolas" size="4"><span style="font-size:14pt">&quot;你好！&quot;</span></font> <font face="Consolas" size="4"><span style="font-size:14pt">);</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">          }</span></font></div><div align="left"><font face="Consolas" size="4"><span style="font-size:14pt">    }</span></font></div><div><span style="font-size: 24px;"><br/></span></div><div style="font-size: 32px;">四、</div><div><img src="注解_files/ScreenClip.png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div><br/></div><div><img src="注解_files/ScreenClip [1].png" type="image/png" height="389" style="cursor: default;cursor: default;" width="1181"/></div><div><span style="font-size: 24px;"><br/></span></div><div><span style="font-size: 24px;"><br/></span></div><div><span style="font-size: 24px;"><br/></span><br/><br/><br/><br/><br/><br/><br/><br/></div></div></div>
</div></body></html> 